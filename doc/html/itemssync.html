<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- organizersync.qdoc -->
  <title>Qt 1.1: Organizer Synchronous API</title>
  <link rel="stylesheet" type="text/css" href="style/style.css"
 />  <!--[if IE]>
<meta name="MSSmartTagsPreventParsing" content="true">
<meta http-equiv="imagetoolbar" content="no">
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" href="style/style_ie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" type="text/css" href="style/style_ie7.css">
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" type="text/css" href="style/style_ie8.css">
<![endif]-->
  <script src="scripts/jquery.js" type="text/javascript"></script>
  <script src="scripts/functions.js" type="text/javascript"></script>
 <script src="./scripts/superfish.js" type="text/javascript"></script>
 <script src="./scripts/narrow.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="style/superfish.css" />  <link rel="stylesheet" type="text/css" href="style/narrow.css" /></head>
<body class="" onload="CheckEmptyAndLoadList();">
 <div class="header" id="qtdocheader">
    <div id="nav-logo">
      <a href="index.html">Home</a></div>
    <a href="index.html" class="qtref"><span>Qt Mobility Reference Documentation</span></a>
    <div id="nav-topright">
      <ul>
        <li class="nav-topright-home"><a href="http://qt.nokia.com/">Qt HOME</a></li>
        <li class="nav-topright-dev"><a href="http://qt.nokia.com/developer">DEV</a></li>
        <li class="nav-topright-labs"><a href="http://labs.qt.nokia.com/blogs/">LABS</a></li>
        <li class="nav-topright-doc nav-topright-doc-active"><a href="http://doc.qt.nokia.com/">
          DOC</a></li>
        <li class="nav-topright-blog"><a href="http://blog.qt.nokia.com/">BLOG</a></li>
        <li class="nav-topright-shop"><a title="SHOP" href="http://shop.qt.nokia.com">SHOP</a></li>
      </ul>
    </div>
    <div id="shortCut">
      <ul>
        <li class="shortCut-topleft-inactive"><span><a href="index.html">Mobility 1.1</a></span></li>
        <li class="shortCut-topleft-active"><a href="http://qt.nokia.com/doc/">ALL Qt VERSIONS        </a></li>
      </ul>
    </div>
  </div>
  <div class="wrapper">
    <div class="hd">
      <span></span>
    </div>
    <div class="bd group">
      <div class="sidebar">
        <div class="searchlabel">
          Search index:</div>
        <div class="search">
          <form id="qtdocsearch" action="">
            <fieldset>
              <input type="text" name="searchstring" id="pageType" value="" />
            </fieldset>
          </form>
        </div>
        <div class="box first bottombar" id="lookup">
          <h2><span></span>
            API Lookup</h2>
          <div  id="list001" class="list">
          <ul id="ul001" >
              <li class="defaultLink"><a href="classes.html">Class index</a></li>
              <li class="defaultLink"><a href="functions.html">Function index</a></li>
              <li class="defaultLink"><a href="modules.html">Modules</a></li>
              <li class="defaultLink"><a href="namespaces.html">Namespaces</a></li>
              <li class="defaultLink"><a href="qtglobal.html">Global stuff</a></li>
              <li class="defaultLink"><a href="qdeclarativeelements.html">QML elements</a></li>
            </ul> 
          </div>
        </div>
        <div class="box bottombar" id="topics">
          <h2><span></span>
            Qt Topics</h2>
          <div id="list002" class="list">
            <ul id="ul002" >
              <li class="defaultLink"><a href="qt-basic-concepts.html">Basic Qt architecture</a></li>
              <li class="defaultLink"><a href="declarativeui.html">Device UI's &amp; Qt Quick</a></li>
              <li class="defaultLink"><a href="qt-gui-concepts.html">Desktop UI components</a></li>
              <li class="defaultLink"><a href="platform-specific.html">Platform-specific info</a></li>
            </ul>  
          </div>
        </div>
        <div class="box" id="examples">
          <h2><span></span>
            Examples</h2>
          <div id="list003" class="list">
        <ul id="ul003">
              <li class="defaultLink"><a href="all-examples.html">Examples</a></li>
              <li class="defaultLink"><a href="tutorials.html">Tutorials</a></li>
              <li class="defaultLink"><a href="demos.html">Demos</a></li>
              <li class="defaultLink"><a href="qdeclarativeexamples.html">QML Examples</a></li>
              <li class="defaultLink"><a href="qdeclarativeexamples.html#Demos">QML Demos</a></li>
            </ul> 
          </div>
        </div>
      </div>
      <div class="wrap">
        <div class="toolbar">
          <div class="breadcrumb toolblock">
            <ul>
              <li class="first"><a href="index.html">Home</a></li>
              <!--  Bread crumbs goes here -->
              <li>Organizer Synchronous API</li>            </ul>
          </div>
          <div class="toolbuttons toolblock">
            <ul>
              <li id="smallA" class="t_button">A</li>
              <li id="medA" class="t_button active">A</li>
              <li id="bigA" class="t_button">A</li>
              <li id="print" class="t_button"><a href="javascript:this.print();">
                <span>Print</span></a></li>
            </ul>
          </div>
        </div>
        <div class="content">
<div class="toc">
<h3>Contents</h3>
<ul>
<li class="level1"><a href="#introduction">Introduction</a></li>
<li class="level1"><a href="#using-the-api">Using The API</a></li>
<li class="level2"><a href="#error-reporting">Error Reporting</a></li>
<li class="level2"><a href="#organizer-item-manipulation">Organizer Item Manipulation</a></li>
<li class="level2"><a href="#schema-manipulation">Schema Manipulation</a></li>
<li class="level1"><a href="#examples-of-usage">Examples Of Usage</a></li>
<li class="level2"><a href="#saving-a-new-item-to-the-default-manager">Saving a new item to the default manager</a></li>
<li class="level2"><a href="#filtering-by-detail-definition-and-value">Filtering by detail definition and value</a></li>
<li class="level3"><a href="#modifying-an-existing-item-and-saving-the-modifications">Modifying an existing item and saving the modifications</a></li>
</ul>
</div>
<h1 class="title">Organizer Synchronous API</h1>
<span class="subtitle"></span>
<div class="descr"/>
<a name="introduction"></a>
<h2>Introduction</h2>
<p>The Organizer Items Synchronous API enables a client to synchronously fetch, update, or remove item data from an item manager. A synchronous API is of most use to clients who wish to perform simple requests where performance or user interface responsiveness is not critical. Synchronous calls to an item manager will block until they are completed, and therefore should not be performed in the GUI thread if the manager is a frontend to an online service or long-latency datastore. The main advantage of the synchronous API is its simplicity and convenience.</p>
<p>Most operations which may be performed using the synchronous API may also be performed using the asynchronous API. It is recommended for most applications that the asynchronous API be used where possible.</p>
<a name="using-the-api"></a>
<h2>Using The API</h2>
<p>The synchronous API offered by the Organizer Items module is available through the <a href="qorganizeritemmanager.html">QOrganizerItemManager</a> class. It consists of three major sections:</p>
<ul>
<li>Error Reporting</li>
<li>Schema Manipulation</li>
<li>Organizer Item Manipulation</li>
</ul>
<a name="error-reporting"></a>
<h3>Error Reporting</h3>
<p>When a synchronous operation fails, clients need to be able to retrieve error information associated with that synchronous operation. The <a href="qorganizeritemmanager.html#error">QOrganizerItemManager::error</a>() function provides this information to clients.</p>
<p>For some synchronous operations (for example, batch save or remove operations) it is possible that multiple errors may occur during the operation. In those cases, the synchronous function will take a pointer to a map of input index to error, which will be filled by the function as required, and the <a href="qorganizeritemmanager.html#error">QOrganizerItemManager::error</a>() function will report the overall operation error.</p>
<p>Error reporting is handled slightly differently in the asynchronous API, in that each instance of an asynchronous request is able to report any overall operation error as well as the finer-grained map of errors, for the operation which it requested.</p>
<a name="organizer-item-manipulation"></a>
<h3>Organizer Item Manipulation</h3>
<p>The most common type of operation that clients will perform involves retrieval or modification of items. The <a href="qorganizeritemmanager.html">QOrganizerItemManager</a> class offers synchronous API to retrieve, create, update and delete items. The create and update operations are provided through the same interface. Both singular and batch operations are offered by the API.</p>
<p>An item is identified by its <a href="qorganizeritemid.html">QOrganizerItemId</a>. This id consists of two parts: a URI which identifies the item manager which stores the item, and the local id of the item in that manager. Some operations which take a pointer to an item as an argument may modify the item during the operation; updating the item id is a common example.</p>
<p>The <a href="qorganizeritemmanager.html">QOrganizerItemManager</a> class provides API for accessing the IDs of items which are stored in the manager:</p>
<ul>
<li>itemIds(const QList&lt;<a href="qorganizeritemsortorder.html">QOrganizerItemSortOrder</a>&gt;&amp; <a href="location-overview.html#sortorders">sortOrders</a> = QList&lt;<a href="qorganizeritemsortorder.html">QOrganizerItemSortOrder</a>&gt;()) const</li>
<li>itemIds(const <a href="qorganizeritemfilter.html">QOrganizerItemFilter</a>&amp; filter, const QList&lt;<a href="qorganizeritemsortorder.html">QOrganizerItemSortOrder</a>&gt;&amp; <a href="location-overview.html#sortorders">sortOrders</a> = QList&lt;<a href="qorganizeritemsortorder.html">QOrganizerItemSortOrder</a>&gt;()) const</li>
</ul>
<p>The item id retrieval functionality is also provided via asynchronous API through the <a href="qorganizeritemlocalidfetchrequest.html">QOrganizerItemLocalIdFetchRequest</a> class.</p>
<p>The synchronous, singular item manipulation functions offered by the <a href="qorganizeritemmanager.html">QOrganizerItemManager</a> class are:</p>
<ul>
<li>item(const QOrganizerItemLocalId&amp; itemId, const <a href="qorganizeritemfetchhint.html">QOrganizerItemFetchHint</a>&amp; fetchHint = QOrganizerItemFetchHint()) const</li>
<li>saveOrganizer Item(<a href="qorganizeritem.html">QOrganizerItem</a>* item)</li>
<li>removeOrganizer Item(const QOrganizerItemLocalId&amp; itemId)</li>
</ul>
<p>The (optional) fetch argument to the item accessor function allows clients to tell the plugin which types of information they wish to retrieve. This argument is a hint only, and may be ignored safely by the plugin, or used by the plugin to optimize the performance of the retrieve operation.</p>
<p>The save operation entails a validation step, where the item's details are checked against the supported schema. If the item is valid, it will be saved. Note that if the item already exists in the database (determined by the id of the item) it will be replaced with the item contained in the argument. This means that clients should not save any item which was retrieved with a non-empty fetchHint defined, or data loss may occur.</p>
<p>Any error which occurs during such singular item manipulation functions may be accessed by calling <a href="qorganizeritemmanager.html#error">QOrganizerItemManager::error</a>() directly after the original synchronous call.</p>
<p>The synchronous, batch item manipulation functions offered by the <a href="qorganizeritemmanager.html">QOrganizerItemManager</a> class are:</p>
<ul>
<li>items(const QList&lt;<a href="qorganizeritemsortorder.html">QOrganizerItemSortOrder</a>&gt;&amp; <a href="location-overview.html#sortorders">sortOrders</a> = QList&lt;<a href="qorganizeritemsortorder.html">QOrganizerItemSortOrder</a>&gt;(), const <a href="qorganizeritemfetchhint.html">QOrganizerItemFetchHint</a>&amp; fetchHint = QOrganizerItemFetchHint()) const</li>
<li>items(const <a href="qorganizeritemfilter.html">QOrganizerItemFilter</a>&amp; filter, const QList&lt;<a href="qorganizeritemsortorder.html">QOrganizerItemSortOrder</a>&gt;&amp; <a href="location-overview.html#sortorders">sortOrders</a> = QList&lt;<a href="qorganizeritemsortorder.html">QOrganizerItemSortOrder</a>&gt;(), const <a href="qorganizeritemfetchhint.html">QOrganizerItemFetchHint</a>&amp; fetchHint = QOrganizerItemFetchHint()) const</li>
<li>saveOrganizer Items(QList&lt;<a href="qorganizeritem.html">QOrganizerItem</a>&gt;* items, QMap&lt;int, <a href="qorganizeritemmanager.html#Error-enum">QOrganizerItemManager::Error</a>&gt;* errorMap)</li>
<li>removeOrganizer Items(QList&lt;QOrganizerItemLocalId&gt;* itemIds, QMap&lt;int, <a href="qorganizeritemmanager.html#Error-enum">QOrganizerItemManager::Error</a>&gt;* errorMap)</li>
</ul>
<p>The batch save and remove functions both take an (optional) pointer to a map of errors. If the pointer is non-null, this map will be filled out with any errors which occur. The overall operation error of any batch manipulation operation may be accessed by calling <a href="qorganizeritemmanager.html#error">QOrganizerItemManager::error</a>() directly after the original synchronous call.</p>
<p>The item manipulation functionality is also provided via asynchronous API through the <a href="qorganizeritemfetchrequest.html">QOrganizerItemFetchRequest</a>, <a href="qorganizeritemsaverequest.html">QOrganizerItemSaveRequest</a>, and <a href="qorganizeritemremoverequest.html">QOrganizerItemRemoveRequest</a> classes.</p>
<a name="schema-manipulation"></a>
<h3>Schema Manipulation</h3>
<p>The schema supported by a plugin is the list of detail definitions which are supported by the plugin. An item which contains a detail of a particular definition which is not supported by the plugin will fail to validate when the user attempts to save it in that manager. The schema also includes any access constraints which may apply to certain details or detail definitions (for example, a particular detail definition might be declared to be unique per-item in a particular manager).</p>
<p>Every plugin will support a slightly different schema, as the schema which can be supported will depend on the semantics and limitations of the underlying storage platform on which the plugin is based. The default schema is described in the <a href="organizerschema.html">Qt Mobility Organizer schema documentation</a>, and plugins should attempt to implement that schema; however no guarantees are given to clients as to the conformance of the schemas supported by various plugins to the default schema.</p>
<p>Some plugins support extensible detail types. This means that third party developers can extend the schema of such plugins at run time (for example, to add a new field to a detail). Some plugins allow third party developers to define new detail types (that is, to add an entirely new detail type to the schema supported by that plugin). Plugins which support these types of operations must report to clients that they support the <a href="qorganizeritemmanager.html#ManagerFeature-enum">QOrganizerItemManager::MutableDefinitions</a> feature.</p>
<p>The synchronous API offers several functions to retrieve or modify the schema supported by a plugin:</p>
<ul>
<li>detailDefinitions(const QString&amp; itemType = QOrganizerItemType::TypeEvent) const</li>
<li>detailDefinition(const QString&amp; definitionName, const QString&amp; itemType = QOrganizerItemType::TypeEvent) const</li>
<li>saveDetailDefinition(const <a href="qorganizeritemdetaildefinition.html">QOrganizerItemDetailDefinition</a>&amp; def, const QString&amp; itemType = QOrganizerItemType::TypeEvent)</li>
<li>removeDetailDefinition(const QString&amp; definitionName, const QString&amp; itemType = QOrganizerItemType::TypeEvent)</li>
</ul>
<p>The schema manipulation functionality is also provided via asynchronous API through the <a href="qorganizeritemdetaildefinitionfetchrequest.html">QOrganizerItemDetailDefinitionFetchRequest</a>, <a href="qorganizeritemdetaildefinitionsaverequest.html">QOrganizerItemDetailDefinitionSaveRequest</a> and <a href="qorganizeritemdetaildefinitionremoverequest.html">QOrganizerItemDetailDefinitionRemoveRequest</a> classes.</p>
<p>Note that the schema supported by a plugin may vary depending on the type of item to which the schema applies. For example, a particular plugin might support name, address, phone number, email address, and gender details for normal items, but only name, address, and phone number details for a group item.</p>
<a name="examples-of-usage"></a>
<h2>Examples Of Usage</h2>
<p>The synchronous API provides the simplest way to access or modify the item information managed by a particular backend. It has the disadvantage that calls block until completion and is therefore most suitable only for applications which interact with local, high-speed datastores.</p>
<a name="saving-a-new-item-to-the-default-manager"></a>
<h3>Saving a new item to the default manager</h3>
<p>The client creates a new non-recurring item, adds some, and saves it to the default store of the default manager.</p>
<pre class="highlightedCode brush: cpp">     <span class="comment">// a default constructed journal will have it's date/time set to the current date/time.</span>
     QOrganizerJournal journal;
     journal.setDescription(&quot;The conference went well.  We all agree that marshmallows are awesome, &quot;\
                     &quot;but we were unable to reach any agreement as to how we could possibly &quot;\
                     &quot;increase our intake of marshmallows.  Several action points were assigned &quot;\
                     &quot;to various members of the group; I have been tasked with finding a good &quot;\
                     &quot;recipe that combines both marshmallows and chocolate, by next Wednesday.&quot;);
     defaultManager.saveItem(&amp;journal);</pre>
<p>We assume the existence of various specialized leaf-classes that allow simple access to details of the item, such as priority, description and display label. These specialized leaf classes may be written by anyone, and simply wrap the functionality provided by <a href="qorganizeritemdetail.html">QOrganizerItemDetail</a> in order to allow simpler access to fields supported by a particular definition.</p>
<a name="filtering-by-detail-definition-and-value"></a>
<h3>Filtering by detail definition and value</h3>
<p>The client utilizes a default manager and asks for any items which match a particular search criteria:</p>
<pre class="highlightedCode brush: cpp">     <span class="comment">// XXX TODO: make this more convenient.</span>
     <span class="comment">// QOrganizerItemLocation::matchLocationName(&quot;Meeting Room 8&quot;) ?</span>
     QOrganizerItemDetailFilter locationFilter;
     locationFilter.setDetailDefinitionName(QOrganizerItemLocation::DefinitionName, QOrganizerItemLocation::FieldLocationName);
     locationFilter.setValue(&quot;Meeting Room 8&quot;);
     QList&lt;QOrganizerItem&gt; entries = defaultManager.items(locationFilter);</pre>
<a name="modifying-an-existing-item-and-saving-the-modifications"></a>
<h4>Modifying an existing item and saving the modifications</h4>
<p>The client retrieves an item, modifies one of its details, adds a new detail, and then saves the item back to the manager.</p>
<pre class="highlightedCode brush: cpp">     journal.addComment(&quot;Serves: 8.  Ingredients: 500g Milk Chocolate, 500g Marshmallows.  Step 1: Put the marshmallows into 8 separate bowls.  Step 2: Melt the chocolate.  Step 3: Pour the chocolate over the marshmallows in the bowls.  Step 4: Put the bowls into the refrigerator for 20 minutes; serve chilled.&quot;);
     if (!defaultManager.saveItem(&amp;journal)) qDebug() &lt;&lt; &quot;Unable to save updated journal!  Error:&quot; &lt;&lt; defaultManager.error();</pre>
</div>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2009-2010 Nokia Corporation and/or its subsidiary(-ies)</td>
<td width="20%" align="center"><a href="trademarks.html">Trademarks</a></td>
<td align="right"><div align="right">Qt Mobility Project 1.1.0</div></td>
</tr></table></div></address>  <script src="scripts/functions.js" type="text/javascript"></script>
</body>
</html>
